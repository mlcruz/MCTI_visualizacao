<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="aux__lib_8py">
    <title>aux_lib.py File Reference</title>
        <simplesect>
            <title> Namespaces </title>
            <para>
                <itemizedlist>
                    <listitem>
                        <para>struct <link linkend="namespaceaux__lib">aux_lib</link></para>
                    </listitem>
                </itemizedlist>
            </para>
        </simplesect>
    <simplesect>
        <title>Detailed Description</title>
    <para>Definition in file C:/Users/PC/source/repos/Trabalho_final_cpd/SimpleGraphNoSQL/aux_lib.py</para>
    </simplesect>
    <literallayout><computeroutput>
1 
2 
3 <emphasis class="comment">#importa&#32;classe&#32;tabela&#32;e&#32;suas&#32;funções&#32;relacionadas</emphasis>
4 <emphasis class="keyword">from</emphasis>&#32;Tabela&#32;<emphasis class="keyword">import</emphasis>&#32;RawTable,&#32;Cell,&#32;get_cell,&#32;Table,&#32;get_name,&#32;normalize,&#32;get_name_labelless
5 
6 
7 <emphasis class="comment">#Importa&#32;Trie&#32;suas&#32;funções&#32;relacionadas</emphasis>
8 <emphasis class="keyword">from</emphasis>&#32;Trie&#32;<emphasis class="keyword">import</emphasis>&#32;Trie,&#32;insert,&#32;walk_to,&#32;generate_reverse_trie,&#32;moonwalk_to,&#32;prefix_search,&#32;get_all_data,&#32;get_label,&#32;suffix_search,&#32;regex_search,&#32;regex_dict_search,&#32;Nodo
9 
10 <emphasis class="comment">#Persistencia</emphasis>
11 <emphasis class="keyword">import</emphasis>&#32;dill
12 
13 <emphasis class="comment">#Lista&#32;diretorios</emphasis>
14 <emphasis class="keyword">from</emphasis>&#32;os&#32;<emphasis class="keyword">import</emphasis>&#32;listdir
15 
16 <emphasis class="keyword">import</emphasis>&#32;curses
17 
18 <emphasis class="comment">#Gerador&#32;para&#32;numeros&#32;de&#32;tabelas</emphasis>
19 <emphasis class="keyword">def&#32;</emphasis>generate_num(tab_loc):
20 &#32;&#32;&#32;&#32;<emphasis class="stringliteral">&apos;&apos;&apos;Gera&#32;o&#32;nome&#32;do&#32;arquivo&#32;de&#32;tabela&#32;a&#32;cada&#32;passo&apos;&apos;&apos;</emphasis>
21 &#32;&#32;&#32;&#32;
22 &#32;&#32;&#32;&#32;index&#32;=&#32;0
23 &#32;&#32;&#32;&#32;
24 &#32;&#32;&#32;&#32;<emphasis class="comment">#lista&#32;com&#32;todos&#32;os&#32;nomes&#32;das&#32;tabelas</emphasis>
25 &#32;&#32;&#32;&#32;tables&#32;=&#32;listdir(tab_loc)
26 &#32;&#32;&#32;&#32;l_tab&#32;=&#32;len(tables)
27 
28 &#32;&#32;&#32;&#32;<emphasis class="keywordflow">while</emphasis>&#32;(index&#32;&lt;&#32;l_tab):
29 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
30 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">yield</emphasis>&#32;tables[index]
31 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;index&#32;=&#32;index&#32;+&#32;1
32 
33 &#32;&#32;&#32;&#32;<emphasis class="keywordflow">return</emphasis>&#32;0
34 
35 <emphasis class="comment">#Gerador&#32;para&#32;locais&#32;de&#32;tabela&#32;a&#32;partir&#32;da&#32;pasta&#32;fonte&#32;da&#32;tabelas</emphasis>
36 <emphasis class="keyword">def&#32;</emphasis>generate_loc(tab_loc):
37 &#32;&#32;&#32;&#32;<emphasis class="stringliteral">&quot;&quot;&quot;Gera&#32;o&#32;local&#32;da&#32;tabela&#32;a&#32;cada&#32;passo&quot;&quot;&quot;</emphasis>
38 &#32;&#32;&#32;&#32;
39 &#32;&#32;&#32;&#32;tabs&#32;=&#32;generate_num(tab_loc)
40 &#32;&#32;&#32;&#32;loc&#32;=&#32;tab_loc+<emphasis class="stringliteral">&quot;\\&quot;</emphasis>
41 &#32;&#32;&#32;&#32;get&#32;=&#32;next(tabs)
42 &#32;&#32;&#32;&#32;
43 
44 &#32;&#32;&#32;&#32;while(get&#32;!=&#32;0):
45 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">yield</emphasis>&#32;loc+get
46 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;get&#32;=&#32;next(tabs)
47 
48 <emphasis class="keyword">def&#32;</emphasis>save_trie(trie,loc):
49 &#32;&#32;&#32;&#32;<emphasis class="stringliteral">&apos;&apos;&apos;Cria&#32;um&#32;arquivo&#32;em&#32;disco&#32;representando&#32;a&#32;Trie&#32;contendo&#32;todos&#32;os&#32;dados&#32;como&#32;um&#32;arquivo&#32;binario.&#32;Pode&#32;ser&#32;revertido&#32;com&#32;load_trie</emphasis>
50 <emphasis class="stringliteral">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;Recebe&#32;uma&#32;trie&#32;e&#32;um&#32;local&#32;para&#32;salvar&#32;o&#32;arquivo&apos;&apos;&apos;</emphasis>
51 &#32;&#32;&#32;&#32;
52 &#32;&#32;&#32;&#32;with&#32;open(loc,<emphasis class="stringliteral">&apos;wb&apos;</emphasis>)&#32;<emphasis class="keyword">as</emphasis>&#32;file:
53 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;dill.dump(trie.strings_dict,file)
54 
55 <emphasis class="keyword">def&#32;</emphasis>load_trie(loc):
56 &#32;&#32;&#32;&#32;<emphasis class="stringliteral">&apos;&apos;&apos;Recebe&#32;um&#32;arquivo&#32;de&#32;memoria&#32;contendo&#32;um&#32;objeto&#32;gerado&#32;por&#32;save_trie&#32;e&#32;retorna&#32;uma&#32;trie&#32;com&#32;dos&#32;dados&apos;&apos;&apos;</emphasis>
57 &#32;&#32;&#32;&#32;with&#32;open(loc,<emphasis class="stringliteral">&apos;rb&apos;</emphasis>)&#32;<emphasis class="keyword">as</emphasis>&#32;file:
58 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;data_dict&#32;=&#32;dill.load(file)
59 
60 &#32;&#32;&#32;&#32;<emphasis class="comment">#Cria&#32;trie&#32;a&#32;partir&#32;do&#32;dicionario&#32;unpicklado</emphasis>
61 &#32;&#32;&#32;&#32;t&#32;=&#32;<link linkend="namespace_trie">Trie</link>()
62 
63 &#32;&#32;&#32;&#32;<emphasis class="keywordflow">for</emphasis>&#32;key&#32;<emphasis class="keywordflow">in</emphasis>&#32;data_dict:
64 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;insert(key,data_dict[key],t.root)
65 
66 &#32;&#32;&#32;&#32;t.yield_strings(t.root)
67 &#32;&#32;&#32;&#32;<emphasis class="comment">#Retorna&#32;trie</emphasis>
68 &#32;&#32;&#32;&#32;<emphasis class="keywordflow">return</emphasis>&#32;t
69 
70 <emphasis class="keyword">def&#32;</emphasis>generate_table_trie(loc):
71 &#32;&#32;&#32;&#32;<emphasis class="stringliteral">&apos;&apos;&apos;Recebe&#32;um&#32;local&#32;de&#32;pasta&#32;contendo&#32;tabelas&#32;pre&#32;formatadas&#32;e&#32;gera&#32;uma&#32;trie&#32;contendo&#32;as&#32;tabelas&#32;como&#32;folha&#32;e&#32;os&#32;caracteres&#32;das&#32;labels&#32;como&#32;nodo</emphasis>
72 <emphasis class="stringliteral">&#32;&#32;&#32;&#32;&#32;&#32;&#32;Retorna&#32;trie&#32;gerada</emphasis>
73 <emphasis class="stringliteral">&#32;&#32;&#32;&#32;&apos;&apos;&apos;</emphasis>
74 
75 &#32;&#32;&#32;&#32;print(<emphasis class="stringliteral">&quot;Generating&#32;Table&#32;Trie...\n&quot;</emphasis>)
76 
77 &#32;&#32;&#32;&#32;<emphasis class="comment">#gera&#32;um&#32;local&#32;de&#32;uma&#32;tabela&#32;fonte&#32;a&#32;cada&#32;passo</emphasis>
78 &#32;&#32;&#32;&#32;tabs&#32;=&#32;generate_loc(loc)
79 
80 &#32;&#32;&#32;&#32;<emphasis class="comment">#Lista&#32;com&#32;as&#32;tabelas</emphasis>
81 &#32;&#32;&#32;&#32;list_tables&#32;=&#32;[]
82 
83 &#32;&#32;&#32;&#32;<emphasis class="comment">#Cria&#32;trie</emphasis>
84 &#32;&#32;&#32;&#32;t&#32;=&#32;<link linkend="namespace_trie">Trie</link>()
85 
86 &#32;&#32;&#32;&#32;<emphasis class="comment">#Cria&#32;lista&#32;de&#32;objetos&#32;tabela</emphasis>
87 &#32;&#32;&#32;&#32;<emphasis class="keywordflow">for</emphasis>&#32;tabela&#32;<emphasis class="keywordflow">in</emphasis>&#32;tabs:
88 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;list_tables.append(Table(RawTable(tabela)))
89 
90 &#32;&#32;&#32;&#32;<emphasis class="comment">#Insere&#32;labels&#32;de&#32;tabela&#32;na&#32;trie</emphasis>
91 &#32;&#32;&#32;&#32;<emphasis class="keywordflow">for</emphasis>&#32;tabela&#32;<emphasis class="keywordflow">in</emphasis>&#32;list_tables:
92 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;insert(tabela.table_label,tabela,t.root)
93 
94 &#32;&#32;&#32;&#32;
95 &#32;&#32;&#32;&#32;<emphasis class="comment">#Preenche&#32;dicionario&#32;de&#32;acesso&#32;da&#32;trie&#32;e&#32;outros&#32;com&#32;strings&#32;pertencentes&#32;a&#32;mesma</emphasis>
96 &#32;&#32;&#32;&#32;t.yield_strings(t.root)
97 
98 &#32;&#32;&#32;&#32;print(<emphasis class="stringliteral">&quot;Generating&#32;Reverse&#32;Table&#32;Trie...\n&quot;</emphasis>)
99 &#32;&#32;&#32;&#32;
100 &#32;&#32;&#32;&#32;<emphasis class="comment">#Gera&#32;trie&#32;reversa&#32;para&#32;busca&#32;por&#32;sufixo</emphasis>
101 &#32;&#32;&#32;&#32;generate_reverse_trie(t)
102 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
103 &#32;&#32;&#32;&#32;<emphasis class="keywordflow">return</emphasis>&#32;t
104 
105 <emphasis class="keyword">def&#32;</emphasis>write_stdscr(stdscr,string,&#32;loc):
106 &#32;&#32;&#32;&#32;<emphasis class="stringliteral">&apos;&apos;&apos;Write&#32;string&#32;in&#32;the&#32;stdscr&#32;using&#32;tuple&#32;loc(x,y)&#32;as&#32;x&#32;and&#32;y&#32;coordinates.&#32;Aligns&#32;new&#32;lines&#32;and&#32;restores&#32;cursor&#32;position&#32;after&apos;&apos;&apos;</emphasis>
107 &#32;&#32;&#32;&#32;
108 &#32;&#32;&#32;&#32;<emphasis class="comment">#Salvo&#32;local&#32;original&#32;do&#32;cursor</emphasis>
109 &#32;&#32;&#32;&#32;loc_cursor&#32;=&#32;stdscr.getyx()
110 
111 &#32;&#32;&#32;&#32;<emphasis class="comment">#Separa&#32;por&#32;new&#32;lines&#32;&#32;&#32;&#32;</emphasis>
112 &#32;&#32;&#32;&#32;str_split&#32;=&#32;string.split(<emphasis class="stringliteral">&apos;\n&apos;</emphasis>)
113 &#32;&#32;&#32;&#32;counter&#32;=&#32;0
114 
115 &#32;&#32;&#32;&#32;<emphasis class="keywordflow">for</emphasis>&#32;line&#32;<emphasis class="keywordflow">in</emphasis>&#32;str_split:
116 
117 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;stdscr.addstr(loc[0]+counter,loc[1],line)
118 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;stdscr.refresh()
119 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;counter&#32;+=&#32;1
120 
121 &#32;&#32;&#32;&#32;stdscr.move(loc_cursor[0],loc_cursor[1])
122 
123 <emphasis class="keyword">def&#32;</emphasis>write_stdscr_a(stdscr,string,&#32;loc,&#32;attrb):
124 &#32;&#32;&#32;&#32;<emphasis class="stringliteral">&apos;&apos;&apos;Write&#32;string&#32;in&#32;the&#32;stdscr&#32;using&#32;tuple&#32;loc(x,y)&#32;as&#32;x&#32;and&#32;y&#32;coordinates&#32;and&#32;attrb&apos;&apos;&apos;</emphasis>
125 &#32;&#32;&#32;&#32;stdscr.addstr(loc[0],loc[1],string,attrb)
126 
127 
128 
    </computeroutput></literallayout>
</section>
